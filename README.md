# dbt Depthy

A Visual Studio Code extension for dbt projects. dbt Depthy adds an annotation to every model ref `{{ ref('my_model') }}` that indicates the depth of that ref within the DAG, like (7) for a model with 6 upstream models between it and the source layer.

## Features

- Displays the dependency depth of each model reference (`ref()` call) directly in the editor
- Color-codes the depth indicators for easy identification of deep dependencies
- Provides helpful tooltips when hovering over or near depth indicators to explain their meaning
- Updates automatically when the manifest file changes

## How It Works

This extension analyzes the dbt project's dependency graph using the manifest.json file generated during `dbt compile`. For each `{{ ref('model_name') }}` call in your SQL files, it adds a parenthesized number showing the depth of that model in the dependency graph.

- **Depth 1-2**: Green indicator (staging models and shallow dependencies)
- **Depth 3-7**: Yellow indicator (medium dependency)
- **Depth 8+**: Red indicator (deep dependency)

## Requirements

- A dbt project with a valid `manifest.json` file (generated by running `dbt compile`)

## Extension Settings

This extension contributes the following settings:

* `dbtDepthy.manifestPath`: Path to the manifest.json file relative to the project root (default: "target/manifest.json")
* `dbtDepthy.mediumDepthThreshold`: Threshold for medium depth (default: 3)
* `dbtDepthy.highDepthThreshold`: Threshold for high depth (default: 8)
* `dbtDepthy.colorLowDepth`: Color for low depth dependencies (default: green)
* `dbtDepthy.colorMediumDepth`: Color for medium depth dependencies (default: yellow)
* `dbtDepthy.colorHighDepth`: Color for high depth dependencies (default: red)

## Usage

1. Open a dbt project in VS Code
2. Run `dbt compile` to generate the manifest.json file
3. Open any model file (.sql) containing `ref()` calls
4. See the depth indicators appear next to each reference

If the indicators don't appear automatically, you can manually refresh the extension by running the command "dbt Depthy: Refresh Manifest" from the command palette.

## Known Issues

- The extension assumes a standard dbt project structure
- Very large dbt projects might experience performance issues

## Release Notes

### 0.1.0

Initial release of dbt Depthy